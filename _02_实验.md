## 实验内容

---

- 实验目的
  - 通过编写文件读写及上锁的程序，进一步熟悉Linux 中文件I/O 相关的应用开发，并且熟练掌握open()、read()、write()、fcntl()等函数的使用。
- 实验内容
  - 用文件I/O函数编写程序，实现数据从源文件到目标文件的转移，即从源文件中读取前面若干字符送到目标文件中，并把源文件中已传送的数据删除。要求：
    - 1) 程序***包含两部分***，分别是生成源文件的生产程序“prod.c”和传输数据到目标文件并删除源文件中已传输数据的转移程序“move.c”；
    - 1) 生产程序功能：
      - 以读写方式打开源文件，若源文件不存在，可以创建并设置权限的初始值为0644；若文件已存在，将文件的内容展示到屏幕上；
      - 自动向源文件中生成字符，字符包括数字和字母，先生成数字，紧接着生成字母，从0开始，0…9a…z作为一个循环，一个循环过后，从0开始重复，例如源文件中生成的字符为“0123456789abcdefghijklmnopqrstuvwxyz0123……”；
      - 生成字符的周期以及要生成的字符数可以通过***参数***传递给进程（默认生成数字的周期为0.2秒，生产40个字符）；
      - 向文件中写入时给文件加写入锁，写入完成后解锁；
    - 2）转移程序功能
      - 转移程序按照指定位置和数目进行字符转移；
      - 首先将源文件的内容展示到屏幕上，询问用户要转移的字符位置和转移的字符数，按照用户的要求从源文件中指定的位置读取相应数目的字符，并转移到目标文件，然后从源文件中删除刚才传输过的数据，最后把目标文件的内容展示到屏幕上。
      - 每次转移的字符数通过用户输入传给进程，用户也可以不做任何输入，直接回车使用默认值，默认值为从文件开头开始，共计5个字符；
      - 向文件中写入时给文件加写入锁，写入之后解锁。

---









































---

## 实验讲解(标准答案)

