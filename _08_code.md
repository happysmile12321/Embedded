# 信号量编程
> linux中，使用信号量通常分为几个步骤。
- 创建信号量集|获取系统已存在信号量集
- - 需要用semget()函数。不同进程通过使用同一个信号量键值来获得同一个信号量集。
- 初始化信号量
- - 需要用到semctl()函数。设置指定信号量的初值。当使用二维信号量时，通常将信号量初始化为1。
- 设置信号量的PV操作
- - 此时调用semop()函数，设置指定信号量集中的指定信号量的PV操作。这一步是同步和互斥的核心工作部分。注意：信号量值只能通过PV操作改变。
- 删除无用信号量
- - 通过semclt()函数的IPC_RMID操作。此时需要注意，在程序中，不应该出现对已经删除的信号量的操作。
## semget()
---  
> 所需头文件
```c
#include <sys/types.h>
#include <sys/ipc.h>
#include <sys/sem.h>
```
> 函数原型
```c
int  semget(key_t  key ,  int  nsems ,  int  semflg)
```

> 函数传入值
```c
key
    信号量集的键值，可通过ftok()函数得到

```

```
ftok()函数生成键值，semget()函数生成标识符。
```
```c
nsems
    需要创建的信号量数目，通常取值为1

```
```c
semflg
    同open()函数的权限位，如使用IPC_CREAT 标志创建新的信号量集，即使该信号量集已经存在（具有同一个键值的信号量集已在系统中存在），也不会出错。如果同时使用IPC_EXCL 标志可以创建一个新的唯一的信号量集，此时如果该信号量集已经存在，该函数会返回出错等

```
> 返回值

```c
成功：信号量集IPC标识符（作用类似于文件标识符，不同在于文件标识符只对当前进程有效，而信号量IPC标识符对所有进程有效，其中IPC为“进程间通信”），在信号量的其他函数中都会使用该值
出错：-1（errno被设置为相应的值）

```

---























